chapter 3 completely modified.